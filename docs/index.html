<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arbitristae · Index Gentium</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            bg: 'var(--bg)',
            fg: 'var(--fg)',
            muted: 'var(--muted)',
            accent: 'var(--accent)',
            accentDark: 'var(--accent-dark)',
            card: 'var(--card)',
            border: 'var(--border)',
            navy: '#1B2838',
          },
          fontFamily: {
            display: ['"Cormorant Garamond"', 'Georgia', 'serif'],
            body: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['"JetBrains Mono"', 'monospace'],
          }
        }
      }
    }
  </script>
  <style>
    :root {
      --bg: #FAFBFC;
      --fg: #1E293B;
      --muted: #64748B;
      --accent: #4A6FA5;
      --accent-dark: #3A5A8A;
      --accent-glow: rgba(74, 111, 165, 0.15);
      --card: #FFFFFF;
      --border: #E2E8F0;
      --border-hover: #CBD5E1;
      --input-bg: #FFFFFF;
      --skeleton-from: #f1f5f9;
      --skeleton-to: #e2e8f0;
      --footer-bg: #0B1A2B;
      --footer-text: #B8C5D4;
      --footer-text-light: #E8EDF3;
      --footer-muted: #5A7089;
      --status-active: #22c55e;
      --dropdown-shadow: rgba(0, 0, 0, 0.12);
      --card-shadow: rgba(0, 0, 0, 0.06);
      --tag-bg: rgba(30, 41, 59, 0.06);
      --tag-selected-border: #1E293B;
    }

    .dark {
      --bg: #0D1926;
      --fg: #E8EDF3;
      --muted: #8BA3BC;
      --accent: #6B9BD1;
      --accent-dark: #4A7AB0;
      --accent-glow: rgba(107, 155, 209, 0.2);
      --card: #152238;
      --border: #243B55;
      --border-hover: #3A5470;
      --input-bg: #0F1D2D;
      --skeleton-from: #1a2d45;
      --skeleton-to: #243B55;
      --dropdown-shadow: rgba(0, 0, 0, 0.4);
      --card-shadow: rgba(0, 0, 0, 0.3);
      --tag-bg: rgba(107, 155, 209, 0.12);
      --tag-selected-border: #6B9BD1;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      height: 100%;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background-color: var(--bg);
      color: var(--fg);
      line-height: 1.6;
      min-height: 100%;
      display: flex;
      flex-direction: column;
      transition: background-color 200ms ease-out, color 200ms ease-out;
    }

    .main-content {
      flex: 1 0 auto;
    }

    .site-footer {
      flex-shrink: 0;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-entrance {
      opacity: 0;
      animation: fadeInUp 250ms ease-out forwards;
    }

    .delay-1 { animation-delay: 0ms; }
    .delay-2 { animation-delay: 80ms; }
    .delay-3 { animation-delay: 150ms; }
    .delay-4 { animation-delay: 250ms; }
    .delay-5 { animation-delay: 350ms; }

    @media (prefers-reduced-motion: reduce) {
      .animate-entrance {
        animation: none;
        opacity: 1;
      }
    }

    /* Theme Toggle */
    .theme-toggle {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      width: 44px;
      height: 44px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 150ms ease-out;
      z-index: 100;
      box-shadow: 0 2px 8px var(--card-shadow);
    }

    .theme-toggle:hover {
      border-color: var(--border-hover);
      color: var(--fg);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px var(--card-shadow);
    }

    .theme-toggle:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .theme-toggle:active {
      transform: translateY(0);
    }

    .theme-toggle .icon-sun,
    .theme-toggle .icon-moon {
      position: absolute;
      transition: opacity 200ms ease-out, transform 200ms ease-out;
    }

    .theme-toggle .icon-moon {
      opacity: 1;
      transform: rotate(0deg) scale(1);
    }

    .theme-toggle .icon-sun {
      opacity: 0;
      transform: rotate(-90deg) scale(0.5);
    }

    .dark .theme-toggle .icon-moon {
      opacity: 0;
      transform: rotate(90deg) scale(0.5);
    }

    .dark .theme-toggle .icon-sun {
      opacity: 1;
      transform: rotate(0deg) scale(1);
    }

    /* Search Module */
    .search-module {
      position: relative;
    }

    .search-input {
      transition: border-color 150ms ease-out, box-shadow 150ms ease-out, background-color 200ms ease-out;
      background-color: var(--input-bg);
    }

    .search-input:hover {
      border-color: var(--border-hover);
      box-shadow: 0 2px 8px var(--card-shadow);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-glow);
    }

    /* Tag Row - Elegant scrollable container */
    .tag-row-wrapper {
      position: relative;
      width: 100%;
      margin-top: 12px;
    }

    .tag-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .tag-scroll-btn {
      flex-shrink: 0;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: var(--card);
      color: var(--muted);
      cursor: pointer;
      transition: all 120ms ease-out;
      opacity: 0;
      pointer-events: none;
    }

    .tag-scroll-btn.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .tag-scroll-btn:hover {
      border-color: var(--border-hover);
      color: var(--fg);
      background: var(--tag-bg);
    }

    .tag-scroll-btn:active {
      transform: scale(0.95);
    }

    .tag-scroll-btn:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .tag-scroll-container {
      flex: 1;
      overflow-x: auto;
      overflow-y: hidden;
      scrollbar-width: none;
      -ms-overflow-style: none;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
    }

    .tag-scroll-container::-webkit-scrollbar {
      display: none;
    }

    .tag-container {
      display: flex;
      flex-wrap: nowrap;
      gap: 8px;
      padding: 2px 0;
    }

    /* Fade indicators */
    .tag-fade-left,
    .tag-fade-right {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 32px;
      pointer-events: none;
      z-index: 5;
      opacity: 0;
      transition: opacity 200ms ease-out;
    }

    .tag-fade-left {
      left: 40px;
      background: linear-gradient(to right, var(--bg) 0%, var(--bg) 40%, transparent 100%);
    }

    .tag-fade-right {
      right: 40px;
      background: linear-gradient(to left, var(--bg) 0%, var(--bg) 40%, transparent 100%);
    }

    .tag-fade-left.visible,
    .tag-fade-right.visible {
      opacity: 1;
    }

    .tag-pill {
      display: inline-flex;
      align-items: center;
      padding: 5px 12px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      font-weight: 400;
      letter-spacing: 0.04em;
      text-transform: none;
      color: var(--muted);
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 4px;
      white-space: nowrap;
      cursor: pointer;
      transition: all 100ms ease-out;
      flex-shrink: 0;
    }

    .tag-pill:hover:not(.selected) {
      color: var(--fg);
      border-color: var(--border-hover);
      background: var(--tag-bg);
    }

    .tag-pill.selected {
      color: var(--fg);
      background: var(--tag-bg);
      border-color: var(--tag-selected-border);
      font-weight: 500;
    }

    .tag-pill:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Dropdown panel */
    .search-dropdown {
      position: relative;
      margin-top: 8px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      box-shadow: 0 12px 32px var(--dropdown-shadow);
      
      display: none;
      opacity: 0;
      transform: translateY(-8px);
      transition: opacity 150ms ease-out, transform 150ms ease-out;
      
      overflow: hidden;
      max-height: 420px;
    }

    .search-dropdown.open {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }

    .dropdown-metadata {
      padding: 12px 16px;
      background: var(--tag-bg);
      border-bottom: 1px solid var(--border);
    }

    .dropdown-metadata-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .dropdown-metadata-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .metadata-stat {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .metadata-stat-value {
      font-weight: 600;
      font-size: 14px;
      color: var(--fg);
    }

    .metadata-stat-label {
      font-size: 12px;
      color: var(--muted);
    }

    .dropdown-results {
      max-height: 300px;
      overflow-y: auto;
      overscroll-behavior: contain;
    }

    .dropdown-results-header {
      padding: 8px 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--muted);
      background: var(--card);
      position: sticky;
      top: 0;
      border-bottom: 1px solid var(--border);
      z-index: 1;
    }

    .search-dropdown-item {
      padding: 12px 16px;
      cursor: pointer;
      transition: background-color 100ms ease-out;
      border-bottom: 1px solid var(--border);
    }

    .search-dropdown-item:last-child {
      border-bottom: none;
    }

    .search-dropdown-item:hover,
    .search-dropdown-item.active {
      background-color: var(--tag-bg);
    }

    .search-dropdown-item.active {
      background-color: var(--accent-glow);
    }

    .search-dropdown-item:focus {
      outline: none;
      background-color: var(--accent-glow);
    }

    .scroll-indicator {
      padding: 10px 16px;
      text-align: center;
      font-size: 11px;
      color: var(--muted);
      background: var(--tag-bg);
      border-top: 1px solid var(--border);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.02em;
    }

    /* Card hover */
    .entity-card {
      transition: transform 150ms ease-out, box-shadow 150ms ease-out, background-color 200ms ease-out;
      background-color: var(--card);
      border-color: var(--border);
    }

    .entity-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 2px;
      background-color: var(--accent);
      opacity: 0;
      transition: opacity 150ms ease-out;
      border-radius: 1px 0 0 1px;
    }

    .entity-card:hover::before {
      opacity: 1;
    }

    .entity-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 24px -8px var(--dropdown-shadow);
    }

    .entity-card:hover .card-title {
      color: var(--accent);
    }

    /* Card status tag */
    .card-tag {
      background: var(--tag-bg);
      color: var(--muted);
    }

    /* Buttons */
    .btn-outline {
      transition: background-color 150ms ease-out, border-color 150ms ease-out;
      background-color: transparent;
    }

    .btn-outline:hover {
      background-color: var(--tag-bg);
      border-color: var(--accent);
    }

    .btn-outline:hover .btn-arrow {
      transform: translateX(3px);
    }

    .btn-arrow {
      transition: transform 150ms ease-out;
    }

    /* View CTA */
    .view-cta {
      transition: color 150ms ease-out;
      color: var(--accent);
    }

    .view-cta:hover {
      color: var(--accent-dark);
    }

    .view-cta:hover .view-arrow {
      transform: translateX(3px);
    }

    .view-arrow {
      transition: transform 150ms ease-out;
    }

    /* Pagination */
    .page-dot {
      transition: background-color 120ms ease-out;
    }

    .pagination-btn {
      transition: color 120ms ease-out;
    }

    .pagination-btn:hover:not(:disabled) {
      color: var(--fg);
    }

    .pagination-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* Focus visible */
    button:focus-visible,
    a:focus-visible,
    input:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Search wrapper underline */
    .search-wrapper {
      position: relative;
    }

    .search-wrapper::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 1px;
      background-color: var(--accent-glow);
      transition: background-color 150ms ease-out;
      border-radius: 0 0 8px 8px;
    }

    .search-wrapper:focus-within::after {
      background-color: var(--accent);
    }

    /* Loading skeleton */
    .loading-skeleton {
      background: linear-gradient(90deg, var(--skeleton-from) 25%, var(--skeleton-to) 50%, var(--skeleton-from) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--muted);
    }

    /* Footer links */
    .footer-link {
      text-decoration: none;
      color: #B8C5D4;
    }

    .footer-link:hover {
      text-decoration: underline;
      text-underline-offset: 4px;
      color: #E8EDF3;
    }

    /* Screen reader only */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Logo image dark mode handling */
    .logo-img {
      transition: opacity 150ms ease-out;
    }

    .dark .logo-img {
      filter: brightness(1.1);
    }

    /* Entrance animation for theme toggle */
    .theme-toggle-animate {
      opacity: 0;
      animation: fadeInUp 250ms ease-out forwards;
      animation-delay: 400ms;
    }
  </style>
</head>
<body>
  
  <!-- Theme Toggle -->
  <button class="theme-toggle theme-toggle-animate" id="themeToggle" aria-label="Toggle dark mode" type="button">
    <svg class="icon-moon w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"/>
    </svg>
    <svg class="icon-sun w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"/>
    </svg>
  </button>

  <div class="main-content">

    <!-- [2] Institutional Hero Layer -->
    <header class="pt-12 pb-16 px-6">
      <div class="max-w-6xl mx-auto text-center">
        
        <div class="animate-entrance delay-1 mb-8">
          <div class="inline-flex items-center justify-center w-20 h-20">
            <img 
              src="logo.png" 
              alt="INDEX GENTIUM Crest" 
              class="logo-img w-16 h-16 object-contain opacity-90"
              onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
            >
            <div class="hidden w-16 h-16 rounded-full border-2 border-border bg-card items-center justify-center">
              <svg class="w-8 h-8 text-fg opacity-60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                <path d="M2 17l10 5 10-5"/>
                <path d="M2 12l10 5 10-5"/>
              </svg>
            </div>
          </div>
        </div>

        <p class="animate-entrance delay-2 font-mono text-xs tracking-[0.2em] text-muted uppercase mb-6">EST. MMXXIV</p>

        <h1 class="animate-entrance delay-2 font-display text-5xl md:text-6xl lg:text-7xl font-medium tracking-tight text-fg mb-4">
          INDEX GENTIUM
        </h1>

        <p class="animate-entrance delay-3 font-display text-xl md:text-2xl italic text-muted mb-6">
          Laboratorium Arbitristae
        </p>

        <p class="animate-entrance delay-3 max-w-xl mx-auto text-muted leading-relaxed">
          A curated registry of sovereign entities, institutions, and classifications for structured inquiry and institutional reference.
        </p>
      </div>
    </header>

    <!-- [3] Inquiry Layer -->
    <section class="pb-8 px-6">
      <div class="max-w-3xl mx-auto animate-entrance delay-4">
        
        <label for="searchInput" class="block font-mono text-xs tracking-[0.15em] text-muted uppercase mb-4 text-center">
          Inquire the Registry
        </label>

        <!-- Search Module -->
        <div class="search-module" id="searchModule">
          <div class="search-wrapper rounded-lg">
            <div class="flex flex-col sm:flex-row gap-3">
              <div class="relative flex-1">
                <input 
                  type="text" 
                  id="searchInput"
                  class="search-input w-full h-14 px-5 pr-12 text-base bg-card border border-border rounded-lg shadow-sm"
                  placeholder="Search sovereign entities, regions, or classifications…"
                  autocomplete="off"
                  aria-label="Search entities"
                  aria-describedby="searchHelp"
                  aria-expanded="false"
                  aria-controls="searchDropdown"
                  aria-autocomplete="list"
                  role="combobox"
                >
                <svg class="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted pointer-events-none" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                  <circle cx="11" cy="11" r="8"/>
                  <path d="m21 21-4.35-4.35"/>
                </svg>
              </div>

              <button class="btn-outline h-14 px-8 border border-border rounded-lg font-medium text-fg flex items-center justify-center gap-2 whitespace-nowrap" aria-label="Explore all entities">
                <span>Explore</span>
                <svg class="btn-arrow w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- Tag Row with elegant scroll -->
          <div class="tag-row-wrapper" id="tagRowWrapper">
            <div class="tag-fade-left" id="tagFadeLeft"></div>
            <div class="tag-fade-right" id="tagFadeRight"></div>
            <div class="tag-row" role="tablist" aria-label="Filter by classification">
              <button 
                class="tag-scroll-btn" 
                id="tagScrollLeft" 
                aria-label="Scroll tags left"
                type="button"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M15 19l-7-7 7-7"/>
                </svg>
              </button>
              <div class="tag-scroll-container" id="tagScrollContainer">
                <div class="tag-container" id="tagContainer">
                  <button class="tag-pill selected" data-filter="all" role="tab" aria-selected="true">
                    All Nations
                  </button>
                </div>
              </div>
              <button 
                class="tag-scroll-btn" 
                id="tagScrollRight" 
                aria-label="Scroll tags right"
                type="button"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M9 5l7 7-7 7"/>
                </svg>
              </button>
            </div>
          </div>

          <p id="searchHelp" class="sr-only">Type to search through sovereign entities, regions, or classifications</p>

          <!-- Dropdown Panel -->
          <div 
            id="searchDropdown" 
            class="search-dropdown" 
            role="listbox"
            aria-label="Search suggestions"
          >
            <div class="dropdown-metadata">
              <div class="dropdown-metadata-title">Registry Summary</div>
              <div class="dropdown-metadata-stats" id="metadataStats">
              </div>
            </div>
            
            <div class="dropdown-results-header" id="resultsHeader">
              Matching Entities
            </div>
            <div class="dropdown-results" id="dropdownResults" role="listbox">
            </div>
            
            <div class="scroll-indicator hidden" id="scrollIndicator">
              Scroll or use arrow keys to see more results
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- [5] Entity Registry Grid -->
    <section class="pb-16 px-6">
      <div class="max-w-6xl mx-auto">
        
        <div id="loadingSkeleton" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <div class="bg-card border border-border rounded-xl p-6">
            <div class="loading-skeleton h-6 w-24 rounded mb-4"></div>
            <div class="loading-skeleton h-5 w-32 rounded mb-3"></div>
            <div class="loading-skeleton h-4 w-full rounded mb-2"></div>
            <div class="loading-skeleton h-4 w-3/4 rounded mb-4"></div>
            <div class="loading-skeleton h-4 w-20 rounded"></div>
          </div>
          <div class="bg-card border border-border rounded-xl p-6 hidden md:block">
            <div class="loading-skeleton h-6 w-24 rounded mb-4"></div>
            <div class="loading-skeleton h-5 w-32 rounded mb-3"></div>
            <div class="loading-skeleton h-4 w-full rounded mb-2"></div>
            <div class="loading-skeleton h-4 w-3/4 rounded mb-4"></div>
            <div class="loading-skeleton h-4 w-20 rounded"></div>
          </div>
          <div class="bg-card border border-border rounded-xl p-6 hidden lg:block">
            <div class="loading-skeleton h-6 w-24 rounded mb-4"></div>
            <div class="loading-skeleton h-5 w-32 rounded mb-3"></div>
            <div class="loading-skeleton h-4 w-full rounded mb-2"></div>
            <div class="loading-skeleton h-4 w-3/4 rounded mb-4"></div>
            <div class="loading-skeleton h-4 w-20 rounded"></div>
          </div>
        </div>

        <div id="entityGrid" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" role="list" aria-label="Entity registry">
        </div>

        <div id="emptyState" class="hidden py-20 text-center">
          <p class="text-muted">No matching entities found.</p>
        </div>

      </div>
    </section>

    <!-- [9] Pagination Layer -->
    <section id="paginationSection" class="hidden pb-20 px-6">
      <div class="max-w-6xl mx-auto flex items-center justify-center gap-6">
        <button id="prevBtn" class="pagination-btn flex items-center gap-2 text-sm text-muted disabled:opacity-40 disabled:cursor-not-allowed" disabled aria-label="Previous page">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          <span>Prev</span>
        </button>

        <div id="pageIndicator" class="flex items-center gap-2" role="tablist" aria-label="Page navigation">
        </div>

        <button id="nextBtn" class="pagination-btn flex items-center gap-2 text-sm text-muted" aria-label="Next page">
          <span>Next</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>
      </div>
    </section>

  </div>

  <footer class="site-footer py-14 md:py-20 lg:py-24 px-6" style="background-color: #0B1A2B;">
    <div class="max-w-6xl mx-auto">
      <p class="font-display text-xl md:text-2xl tracking-widest text-center mb-10 md:mb-12" style="color: #E8EDF3;">ARBITRISTAE</p>
      <nav class="flex flex-col md:flex-row justify-center items-center gap-6 md:gap-10 mb-10 md:mb-12" aria-label="Footer navigation">
        <a href="#" class="footer-link text-sm">About</a>
        <a href="#" class="footer-link text-sm">Methodology</a>
        <a href="#" class="footer-link text-sm">Contact</a>
      </nav>
      <p class="font-mono text-xs tracking-wide text-center" style="color: #5A7089;">MMXXIV</p>
    </div>
  </footer>

  <script>
    // =============================================
    // Theme Management
    // =============================================
    const themeToggle = document.getElementById('themeToggle');
    const htmlElement = document.documentElement;
    
    function getSystemTheme() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    
    function getStoredTheme() {
      return localStorage.getItem('index-gentium-theme');
    }
    
    function setTheme(theme) {
      if (theme === 'dark') {
        htmlElement.classList.add('dark');
      } else {
        htmlElement.classList.remove('dark');
      }
      localStorage.setItem('index-gentium-theme', theme);
      
      // Update aria label
      themeToggle.setAttribute('aria-label', theme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode');
    }
    
    function initTheme() {
      const storedTheme = getStoredTheme();
      if (storedTheme) {
        setTheme(storedTheme);
      } else {
        setTheme(getSystemTheme());
      }
    }
    
    themeToggle.addEventListener('click', () => {
      const currentTheme = htmlElement.classList.contains('dark') ? 'dark' : 'light';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      setTheme(newTheme);
    });
    
    // Listen for system theme changes
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
      if (!getStoredTheme()) {
        setTheme(e.matches ? 'dark' : 'light');
      }
    });
    
    // Initialize theme immediately
    initTheme();

    // =============================================
    // State Initialization
    // =============================================
    let entities = [];
    let currentFilter = 'all';
    let currentPage = 1;
    const itemsPerPage = 6;
    let filteredEntities = [];
    
    // Dropdown state
    let dropdownOpen = false;
    let activeIndex = -1;
    let currentMatches = [];
    const VISIBLE_ITEMS = 5;

    // DOM Elements
    const searchModule = document.getElementById('searchModule');
    const searchInput = document.getElementById('searchInput');
    const searchDropdown = document.getElementById('searchDropdown');
    const metadataStats = document.getElementById('metadataStats');
    const dropdownResults = document.getElementById('dropdownResults');
    const resultsHeader = document.getElementById('resultsHeader');
    const scrollIndicator = document.getElementById('scrollIndicator');
    const entityGrid = document.getElementById('entityGrid');
    const loadingSkeleton = document.getElementById('loadingSkeleton');
    const emptyState = document.getElementById('emptyState');
    const pageIndicator = document.getElementById('pageIndicator');
    const paginationSection = document.getElementById('paginationSection');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const tagContainer = document.getElementById('tagContainer');
    const tagScrollContainer = document.getElementById('tagScrollContainer');
    const tagScrollLeft = document.getElementById('tagScrollLeft');
    const tagScrollRight = document.getElementById('tagScrollRight');
    const tagFadeLeft = document.getElementById('tagFadeLeft');
    const tagFadeRight = document.getElementById('tagFadeRight');

    // Tag scroll functionality
    function updateTagScrollState() {
      const scrollEl = tagScrollContainer;
      const scrollWidth = scrollEl.scrollWidth;
      const clientWidth = scrollEl.clientWidth;
      const scrollLeft = scrollEl.scrollLeft;
      const hasOverflow = scrollWidth > clientWidth + 1;
      const canScrollLeft = scrollLeft > 2;
      const canScrollRight = scrollLeft < scrollWidth - clientWidth - 2;

      tagScrollLeft.classList.toggle('visible', hasOverflow && canScrollLeft);
      tagScrollRight.classList.toggle('visible', hasOverflow && canScrollRight);
      tagFadeLeft.classList.toggle('visible', canScrollLeft);
      tagFadeRight.classList.toggle('visible', canScrollRight);
    }

    function scrollTags(direction) {
      const scrollAmount = 150;
      const targetScroll = tagScrollContainer.scrollLeft + (direction === 'left' ? -scrollAmount : scrollAmount);
      tagScrollContainer.scrollTo({ left: targetScroll, behavior: 'smooth' });
    }

    tagScrollLeft.addEventListener('click', () => scrollTags('left'));
    tagScrollRight.addEventListener('click', () => scrollTags('right'));
    tagScrollContainer.addEventListener('scroll', updateTagScrollState, { passive: true });

    // Keyboard navigation for tags
    tagScrollContainer.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        e.preventDefault();
        scrollTags('left');
      } else if (e.key === 'ArrowRight') {
        e.preventDefault();
        scrollTags('right');
      }
    });

    function getClassificationCounts() {
      const counts = {};
      entities.forEach(entity => {
        if (Array.isArray(entity.tags)) {
          entity.tags.forEach(tag => {
            counts[tag] = (counts[tag] || 0) + 1;
          });
        }
      });
      return counts;
    }

    function renderTags() {
      const classCounts = getClassificationCounts();
      const tagNames = Object.keys(classCounts);
      
      const allNationsTag = tagContainer.querySelector('[data-filter="all"]');
      tagContainer.innerHTML = '';
      tagContainer.appendChild(allNationsTag);
      
      tagNames.forEach(tagName => {
        const tag = document.createElement('button');
        tag.className = 'tag-pill';
        tag.setAttribute('data-filter', tagName);
        tag.setAttribute('role', 'tab');
        tag.setAttribute('aria-selected', 'false');
        tag.textContent = tagName;
        tagContainer.appendChild(tag);
      });

      attachTagListeners();
      
      // Update scroll state after tags are rendered
      requestAnimationFrame(() => {
        updateTagScrollState();
      });
    }

    function attachTagListeners() {
      const tags = tagContainer.querySelectorAll('.tag-pill');
      tags.forEach(tag => {
        tag.addEventListener('click', () => {
          tags.forEach(t => {
            t.classList.remove('selected');
            t.setAttribute('aria-selected', 'false');
          });
          tag.classList.add('selected');
          tag.setAttribute('aria-selected', 'true');
          
          currentFilter = tag.dataset.filter;
          filterEntities();
        });
      });
    }

    function renderMetadata(matchCount) {
      const classCounts = getClassificationCounts();
      const totalEntities = entities.length;
      
      let statsHTML = `
        <div class="metadata-stat">
          <span class="metadata-stat-value">${totalEntities}</span>
          <span class="metadata-stat-label">Total</span>
        </div>
      `;
      
      const entries = Object.entries(classCounts).slice(0, 3);
      entries.forEach(([tag, count]) => {
        statsHTML += `
          <div class="metadata-stat">
            <span class="metadata-stat-value">${count}</span>
            <span class="metadata-stat-label">${tag}</span>
          </div>
        `;
      });
      
      metadataStats.innerHTML = statsHTML;
      
      if (matchCount > 0) {
        resultsHeader.textContent = `${matchCount} Matching ${matchCount === 1 ? 'Entity' : 'Entities'}`;
      } else {
        resultsHeader.textContent = 'No Matches';
      }
    }

    async function loadCatalog() {
      try {
        const response = await fetch('catalog.json');
        if (!response.ok) throw new Error('Catalog not found');
        
        const data = await response.json();
        entities = data.countries || [];
        filteredEntities = [...entities];

        renderTags();

        loadingSkeleton.classList.add('hidden');
        entityGrid.classList.remove('hidden');
        
        renderGrid();
      } catch (error) {
        console.error('Failed to load catalog:', error);
        loadingSkeleton.classList.add('hidden');
        emptyState.classList.remove('hidden');
        emptyState.innerHTML = '<p class="text-muted">Unable to load registry data.</p><p class="text-sm text-muted/60 mt-2">Please ensure catalog.json is available.</p>';
      }
    }

    function openDropdown() {
      dropdownOpen = true;
      searchDropdown.classList.add('open');
      searchInput.setAttribute('aria-expanded', 'true');
    }

    function closeDropdown() {
      dropdownOpen = false;
      activeIndex = -1;
      searchDropdown.classList.remove('open');
      searchInput.setAttribute('aria-expanded', 'false');
      clearActiveItem();
    }

    function clearActiveItem() {
      const items = dropdownResults.querySelectorAll('.search-dropdown-item');
      items.forEach(item => item.classList.remove('active'));
    }

    function setActiveItem(index) {
      const items = dropdownResults.querySelectorAll('.search-dropdown-item');
      clearActiveItem();
      if (index >= 0 && index < items.length) {
        items[index].classList.add('active');
        items[index].scrollIntoView({ block: 'nearest' });
      }
    }

    function selectItem(index) {
      if (index >= 0 && index < currentMatches.length) {
        const entity = currentMatches[index];
        searchInput.value = entity.name;
        closeDropdown();
        filterEntities();
      }
    }

    function renderDropdown(term) {
      if (term.length < 2) {
        currentMatches = [];
        renderMetadata(0);
        dropdownResults.innerHTML = `
          <div class="px-4 py-6 text-center text-sm text-muted">
            Type at least 2 characters to search
          </div>
        `;
        scrollIndicator.classList.add('hidden');
        openDropdown();
        return;
      }

      currentMatches = entities.filter(e => {
        const nameMatch = e.name.toLowerCase().includes(term.toLowerCase());
        const tagMatch = Array.isArray(e.tags) && e.tags.some(t => t.toLowerCase().includes(term.toLowerCase()));
        return nameMatch || tagMatch;
      });

      renderMetadata(currentMatches.length);

      if (currentMatches.length === 0) {
        dropdownResults.innerHTML = `
          <div class="px-4 py-6 text-center text-sm text-muted">
            No entities found
          </div>
        `;
        scrollIndicator.classList.add('hidden');
        openDropdown();
        return;
      }

      dropdownResults.innerHTML = currentMatches.map((entity, idx) => `
        <div 
          class="search-dropdown-item" 
          data-index="${idx}"
          role="option"
          tabindex="-1"
          aria-selected="false"
        >
          <div class="flex items-center gap-3">
            <span class="text-lg" aria-hidden="true">${entity.icon}</span>
            <div class="flex-1 min-w-0">
              <p class="font-medium text-fg truncate">${entity.name}</p>
              <p class="text-xs text-muted">${Array.isArray(entity.tags) ? entity.tags.join(', ') : ''}</p>
            </div>
          </div>
        </div>
      `).join('');

      if (currentMatches.length > VISIBLE_ITEMS) {
        scrollIndicator.classList.remove('hidden');
        scrollIndicator.textContent = `${currentMatches.length - VISIBLE_ITEMS} more — scroll or use arrow keys`;
      } else {
        scrollIndicator.classList.add('hidden');
      }

      const items = dropdownResults.querySelectorAll('.search-dropdown-item');
      items.forEach((item, idx) => {
        item.addEventListener('mouseenter', () => {
          activeIndex = idx;
          setActiveItem(idx);
        });
        item.addEventListener('click', () => {
          selectItem(idx);
        });
      });

      activeIndex = -1;
      openDropdown();
    }

    function renderCard(entity) {
      const code = entity.code || entity.name.substring(0, 2).toUpperCase() + '-001';
      
      const tagsHTML = Array.isArray(entity.tags) 
        ? entity.tags.map(tag => `
            <span class="card-tag inline-block px-2 py-0.5 text-xs font-mono tracking-wide rounded">${tag}</span>
          `).join('')
        : '';
      
      return `
        <article class="entity-card relative border rounded-xl p-6 shadow-sm" role="listitem">
          <div class="flex items-start justify-between mb-4">
            <div class="flex items-center gap-3">
              <span class="text-2xl" aria-hidden="true">${entity.icon}</span>
              <div class="flex flex-wrap gap-1">
                ${tagsHTML}
              </div>
            </div>
            <span class="flex items-center gap-1.5 text-xs text-muted">
              <span class="w-1.5 h-1.5 rounded-full" style="background-color: var(--status-active);" aria-hidden="true"></span>
              <span class="sr-only">Status:</span>Active
            </span>
          </div>
          
          <h3 class="card-title font-display text-xl font-medium text-fg mb-2 transition-colors duration-150">${entity.name}</h3>
          <p class="text-sm text-muted leading-relaxed mb-4">${entity.description}</p>
          
          <div class="flex items-center justify-between pt-4 border-t border-border">
            <span class="font-mono text-xs text-muted/60">${code}</span>
            <a href="${entity.link}" class="view-cta inline-flex items-center gap-1.5 text-sm font-medium" aria-label="View details for ${entity.name}">
              <span>View</span>
              <svg class="view-arrow w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            </a>
          </div>
        </article>
      `;
    }

    function renderGrid() {
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const pageEntities = filteredEntities.slice(startIndex, endIndex);

      if (filteredEntities.length === 0) {
        entityGrid.classList.add('hidden');
        emptyState.classList.remove('hidden');
        emptyState.innerHTML = '<p class="text-muted">No matching entities found.</p>';
        paginationSection.classList.add('hidden');
      } else {
        emptyState.classList.add('hidden');
        entityGrid.classList.remove('hidden');
        entityGrid.innerHTML = pageEntities.map(renderCard).join('');
        
        if (filteredEntities.length > itemsPerPage) {
          paginationSection.classList.remove('hidden');
          renderPagination();
        } else {
          paginationSection.classList.add('hidden');
        }
      }
    }

    function renderPagination() {
      const totalPages = Math.max(1, Math.ceil(filteredEntities.length / itemsPerPage));
      
      let dotsHTML = '';
      for (let i = 1; i <= totalPages; i++) {
        const isActive = i === currentPage;
        dotsHTML += `
          <button 
            class="page-dot ${isActive ? 'w-6 h-2' : 'w-2 h-2 bg-border hover:bg-muted'} rounded-full transition-all duration-120" 
            style="${isActive ? 'background-color: var(--accent);' : ''}"
            data-page="${i}" 
            aria-label="Page ${i}" 
            aria-selected="${isActive}"
            role="tab"
          ></button>
        `;
      }
      pageIndicator.innerHTML = dotsHTML;

      prevBtn.disabled = currentPage === 1;
      nextBtn.disabled = currentPage === totalPages;

      document.querySelectorAll('.page-dot').forEach(dot => {
        dot.addEventListener('click', () => {
          currentPage = parseInt(dot.dataset.page);
          renderGrid();
          entityGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
      });
    }

    function filterEntities() {
      const searchTerm = searchInput.value.toLowerCase().trim();
      
      filteredEntities = entities.filter(entity => {
        const matchesFilter = currentFilter === 'all' || 
          (Array.isArray(entity.tags) && entity.tags.includes(currentFilter));
        
        const matchesSearch = searchTerm === '' || 
          entity.name.toLowerCase().includes(searchTerm) ||
          entity.description.toLowerCase().includes(searchTerm) ||
          (Array.isArray(entity.tags) && entity.tags.some(t => t.toLowerCase().includes(searchTerm)));
        
        return matchesFilter && matchesSearch;
      });

      currentPage = 1;
      renderGrid();
    }

    // Search Input Events
    searchInput.addEventListener('input', (e) => {
      renderDropdown(e.target.value);
      filterEntities();
    });

    searchInput.addEventListener('focus', () => {
      renderDropdown(searchInput.value);
    });

    // Keyboard Navigation
    searchInput.addEventListener('keydown', (e) => {
      const items = dropdownResults.querySelectorAll('.search-dropdown-item');
      
      if (!dropdownOpen) {
        if (e.key === 'ArrowDown' && searchInput.value.length >= 2) {
          e.preventDefault();
          renderDropdown(searchInput.value);
        }
        return;
      }

      switch (e.key) {
        case 'ArrowDown':
          e.preventDefault();
          activeIndex = Math.min(activeIndex + 1, items.length - 1);
          setActiveItem(activeIndex);
          break;
        case 'ArrowUp':
          e.preventDefault();
          activeIndex = Math.max(activeIndex - 1, 0);
          setActiveItem(activeIndex);
          break;
        case 'Enter':
          e.preventDefault();
          if (activeIndex >= 0 && activeIndex < items.length) {
            selectItem(activeIndex);
          }
          break;
        case 'Escape':
          e.preventDefault();
          closeDropdown();
          searchInput.focus();
          break;
        case 'Tab':
          closeDropdown();
          break;
      }
    });

    // Click outside to close
    document.addEventListener('click', (e) => {
      const isInsideSearchModule = searchModule.contains(e.target);
      const isTagPill = e.target.closest('.tag-pill');
      const isThemeToggle = e.target.closest('.theme-toggle');
      
      if (!isInsideSearchModule && !isTagPill && !isThemeToggle) {
        closeDropdown();
      }
    });

    // Pagination buttons
    prevBtn.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderGrid();
        entityGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });

    nextBtn.addEventListener('click', () => {
      const totalPages = Math.ceil(filteredEntities.length / itemsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        renderGrid();
        entityGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });

    // Window resize handler for tag scroll
    window.addEventListener('resize', () => {
      updateTagScrollState();
    });

    // Initialize
    loadCatalog();
  </script>
</body>
</html>